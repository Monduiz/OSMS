{% extends "layout.html" %}
{% load widget_tweaks %}
{% load static %}
{% block otherStyles %}
  <link rel="stylesheet" type="text/css" href="{% static 'main/css/profile.css' %}">
{% endblock otherStyles %}
{% block content %}

<!-- Grid row -->
<div class="row">
  <div class="col-lg-4 col-sm-12 sidebarpad pr-1">
    <div class="card">
      <div class='sidebar'>
        <div class="img-fluid">
            <img src="{{ user.profile.image.url }}" class="img-fluid z-depth-1" alt="Card image cap">
        </div>
        <br>

      <div class="profile-head">
        <h4><strong>{{user.username}}</strong></h4>
        <h3>{{ user.firstname }} <span style="text-transform: uppercase;">{{ user.lastname }}</span></h3>
        <h5>{{ user.directorate }}</h5>
      </div>
      <hr id="profile-head-hr">
      <ul class="nav flex-column nav-pills nav-fill mb-3" id="pills-tab" role="tablist">
        <li class="nav-item pill-1">
          <a class="nav-link active" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab"
            aria-controls="pills-profile" aria-selected="true">Profile</a>
        </li>
        <li class="nav-item pill-2">
          <a class="nav-link" id="pills-trips-tab" data-toggle="pill" href="#pills-trips" role="tab"
            aria-controls="pills-trips" aria-selected="false">Activities</a>
        </li>
        <li class="nav-item pill-3">
          <a class="nav-link" id="pills-hoir-tab" data-toggle="pill" href="#pills-hoir" role="tab"
            aria-controls="pills-hoir" aria-selected="false">HOIRs</a>
        </li>
        <li class="nav-item pill-4">
          <a class="nav-link" id="pills-ocsr-tab" data-toggle="pill" href="#pills-oscr" role="tab"
            aria-controls="pills-oscr" aria-selected="false">OSCRs</a>
        </li>
        <li class="nav-item pill-5">
          <a class="nav-link" id="pills-closeout-tab" data-toggle="pill" href="#pills-closeout" role="tab"
            aria-controls="pills-closeout" aria-selected="false">Close-out</a>
        </li>
      </ul>
      </div>
    </div>
  </div>

  <div class="col-lg-8 col-sm-12 profilepad pl-1">
    <div class="card profile-card">
        <div class="card-body">
          <div class="tab-content" id="pills-tabContent">
            <!-- Profile start -->
            <div class="tab-pane fade show active" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
              <h2>Profile</h2>
              <hr id="title_hr">
              <br>
              <form id="editForm" method="POST" action="" enctype="multipart/form-data">
                  {% csrf_token %}
                  <!-- First and Last name -->
                  <div class="form-row">
                    <!-- Username -->
                    <div class="md-form md-modal">
                      <label for="id_username">Username</label>
                      {% render_field u_form.username class="form-control md-modal" %}
                      {{ u_form.username.errors }}
                    </div>
                    <div class="col">
                      <!-- First name -->
                      <div class="md-form md-modal">
                        <label for="id_firstname">First name</label>
                        {% render_field u_form.firstname class="form-control md-modal" %}
                        <div class="help-block">{{ u_form.firstname.errors }}</div>
                      </div>
                    </div>
                    <div class="col">
                      <!-- Last name -->
                      <div class="md-form md-modal">
                        <label for="id_lastname">Last name</label>
                        {% render_field u_form.lastname class="form-control md-modal" %}
                        <div class="help-block">{{ u_form.lastname.errors }}</div>
                      </div>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="col">
                      <!-- Phone number -->
                      <div class="md-form md-modal">
                        <label for="id_phone">Phone number</label>
                        {% render_field u_form.phone class="form-control md-modal" %}
                        <div class="help-block">{{ u_form.phone.errors }}</div>
                      </div>
                    </div>
                    <div class="col">
                      <!-- E-mail -->
                      <div class="md-form md-modal">
                        <label for="id_email">Email</label>
                        {% render_field u_form.email class="form-control md-modal" %}
                        <div class="help-block">{{ u_form.email.errors }}</div>
                      </div>
                    </div>
                    <div class="col">
                      <!-- Directorate -->
                      <div class="form-group md-modal">
                        <label for="id_directorate">Directorate</label>
                        {% render_field u_form.directorate class="mdb-select md-form md-modal colorful-select dropdown-default" %}
                        {{ u_form.directorate.errors }}
                      </div>
                    </div>
                  </div>
                  <!-- Profile picture -->
                  <h5 class="ml-0 mr-0">Profile image:</h5>
                  <p>Currently: <strong style="color:#2BBBAD">{{p_form.image.value}}</strong></p>
                  <div class="md-form">
                    <div class="file-field">
                      <div class="btn btn-default btn-sm float-left">
                        <span>Choose file</span>
                        <input type="file" id="id_image" name="image">
                      </div>
                      <div class="file-path-wrapper">
                        <input class="file-path validate md-modal" type="text" placeholder="Upload your file">
                      </div>
                      {% if p_form.picture.errors %}
                        {% for error in p_form.picture.errors %}
                          <br><span class="text-danger">{{ error }}</span><br>
                        {% endfor %}
                      {% endif %}
                    </div>
                  </div>
                  <br>
                  <div class="text-center">
                    <button class="btn btn-default btn-rounded btn-sm" type="submit">Save changes</button>
                    <a href="{% url 'password_change' %}" class="btn btn-default btn-rounded btn-sm">Change password</a>
                    <a href="{% url 'dash' %}" class="btn btn-dash btn-rounded btn-sm">Dashboard</a>
                  </div>
              </form>
            </div>
            <!-- Profile end -->
            <div class="tab-pane fade" id="pills-trips" role="tabpanel" aria-labelledby="pills-trips-tab">
              <h2>Activities</h2>
              <hr id="title_hr_trip">
              <br>
              {% for trip in trips_list %}
                <section class="my-1">
                  <!-- Section heading -->
                  <div class="row">
                    <div class="col-lg-8 col-xl-10">
                      <h3 class="font-weight-bold mb-3"><strong>{{ trip.dest_name }}</strong></h3>
                      <h2><a class="article-title">{{ trip.purpose }}</a></h2>
                      <p class="dark-grey-text"">{{ trip.dest_city }}, {{ trip.dest_province }}</p>
                      <p><a class="dark-grey-text">Risk score: <strong>{{ trip.risk_sum }}</strong></a></p>
                      <p>by <a class="font-weight-bold">{{ trip.officer.username }}</a>, {{ trip.date_created|date:'F d, Y' }}</p>
                      <a href="{% url 'trip-detail' trip.id %}" class="btn btn-trip btn-rounded btn-sm">Read</a>
                      <a href="{% url 'trip-update' trip.id %}" class="btn btn-trip btn-rounded btn-sm">Update</a>
                      <a href="#" class="btn btn-trip btn-rounded btn-sm">PDF</a>
                    </div>
                  </div>
                </section>
                <hr class="my-5">
              {% endfor %}
              <!-- pagination start -->
                <nav>
                  <ul class="pagination pg-trip">
                    {% if trips_list.has_previous %}
                    <li class="page-item">
                      <a class="page-link" href="?page1={{ trips_list.previous_page_number }}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Previous</span>
                      </a>
                    </li>
                    {% endif %}
                    {% for num in trips_list.paginator.page_range %}
                      {% if trips_list.number == num %}
                        <li class="page-item active"><a class="page-link" href="?page1={{ num }}">{{ num }}</a></li>
                      {% else %}
                        <li class="page-item"><a class="page-link" href="?page1={{ num }}">{{ num }}</a></li>
                      {% endif %}
                    {% endfor %}
                    {% if trips_list.has_next %}
                      <li class="page-item">
                        <a class="page-link" href="?page1={{ trips_list.next_page_number }}"aria-label="Next">
                          <span aria-hidden="true">&raquo;</span>
                          <span class="sr-only">Next</span>
                        </a>
                      </li>
                      {% endif %}
                  </ul>
                </nav>
                <!-- pagination end -->
            </div>
            <div class="tab-pane fade" id="pills-hoir" role="tabpanel" aria-labelledby="pills-hoir-tab">

              <h2>HOIRs</h2>
              <hr id="title_hr_HOIR">
              <br>
              {% for hoir in hoir_list %}
              <section class="my-1">
                <!-- Section heading -->
                <div class="row">
                  <div class="col-lg-8 col-xl-10">
                    <h3 class="font-weight-bold mb-3"><strong>{{ hoir.injury_description }}</strong></h3>
                    <p>by <a class="font-weight-bold">{{ hoir.officer.username }}</a>, {{ hoir.date_created|date:'F d, Y' }}</p>
                    {% if hoir.officer == user %}
                      <a href="{% url 'hoir-detail' hoir.id %}" class="btn btn-pink btn-rounded btn-sm">Read</a>
                      <a href="#" class="btn btn-pink btn-rounded btn-sm">Update</a>
                      <a href="{% url 'hoir-print' hoir.id %}" class="btn btn-pink btn-rounded btn-sm">PDF</a>
                    {% endif %}
                  </div>
                </div>
              </section>
              <hr class="my-5">
            {% endfor %}
            <!-- pagination start -->
              <nav>
                <ul class="pagination pg-hoir">
                  {% if hoir_list.has_previous %}
                  <li class="page-item">
                    <a class="page-link" href="?page2={{ hoir_list.previous_page_number }}" aria-label="Previous">
                      <span aria-hidden="true">&laquo;</span>
                      <span class="sr-only">Previous</span>
                    </a>
                  </li>
                  {% endif %}
                  {% for num in hoir_list.paginator.page_range %}
                    {% if hoir_list.number == num %}
                      <li class="page-item active"><a class="page-link" href="?page2={{ num }}">{{ num }}</a></li>
                    {% elif num > hoir_list.number|add:'-3' and num < hoir_list.number|add:'3' %}
                      <li class="page-item"><a class="page-link" href="?page2={{ num }}">{{ num }}</a></li>
                    {% endif %}
                  {% endfor %}
                  {% if hoir_list.has_next %}
                    <li class="page-item">
                      <a class="page-link" href="?page2={{ hoir_list.next_page_number }}"aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                        <span class="sr-only">Next</span>
                      </a>
                    </li>
                    {% endif %}
                </ul>
              </nav>
              <!-- pagination end -->
            </div>
            <div class="tab-pane fade" id="pills-oscr" role="tabpanel" aria-labelledby="pills-oscr-tab">
              <h2>OSCRs</h2>
              <hr id="title_hr_OSCR">
              <br>
              {% for oscr in oscr_list %}
              <section class="my-1">
                <!-- Section heading -->
                <div class="row">
                  <div class="col-lg-8 col-xl-10">
                    <h3 class="font-weight-bold mb-3"><strong>{{ oscr.officer.username  }}</strong></h3>
                    <p>by <a class="font-weight-bold">{{ oscr.officer.username }}</a>, {{ oscr.date_created|date:'F d, Y' }}</p>
                    {% if oscr.officer == user %}
                      <a href="{% url 'oscr-detail' oscr.id %}" class="btn btn-deep-orange btn-rounded btn-sm">Read</a>
                      <a href="#" class="btn btn-deep-orange btn-rounded btn-sm">Update</a>
                      <a href="#" class="btn btn-deep-orange btn-rounded btn-sm">PDF</a>
                    {% endif %}
                  </div>
                </div>
              </section>
              <hr class="my-5">
              {% endfor %}
              <!-- pagination start -->
                <nav>
                  <ul class="pagination pg-oscr">
                    {% if oscr_list.has_previous %}
                    <li class="page-item">
                      <a class="page-link" href="?page3={{ oscr_list.previous_page_number }}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Previous</span>
                      </a>
                    </li>
                    {% endif %}
                    {% for num in oscr_list.paginator.page_range %}
                      {% if oscr_list.number == num %}
                        <li class="page-item active"><a class="page-link" href="?page3={{ num }}">{{ num }}</a></li>
                      {% elif num > oscr_list.number|add:'-3' and num < oscr_list.number|add:'3' %}
                        <li class="page-item"><a class="page3-link" href="?page={{ num }}">{{ num }}</a></li>
                      {% endif %}
                    {% endfor %}
                    {% if oscr_list.has_next %}
                      <li class="page-item">
                        <a class="page-link" href="?page3={{ oscr_list.next_page_number }}"aria-label="Next">
                          <span aria-hidden="true">&raquo;</span>
                          <span class="sr-only">Next</span>
                        </a>
                      </li>
                      {% endif %}
                  </ul>
                </nav>
                <!-- pagination end -->
            </div>
            <div class="tab-pane fade" id="pills-closeout" role="tabpanel" aria-labelledby="pills-closeout-tab">
              <h2>Close-outs</h2>
              <hr id="title_hr_closeout">
              <br>
              {% for closeout in closeout_list %}
              <section class="my-1">
                <!-- Section heading -->
                <div class="row">
                  <div class="col-lg-8 col-xl-10">
                    <h3 class="font-weight-bold mb-3"><strong>{{ closeout.officer.username  }}</strong></h3>
                    <p>by <a class="font-weight-bold">{{ closeout.officer.username }}</a>, {{ closeout.date_created|date:'F d, Y' }}</p>
                    {% if closeout.officer == user %}
                      <a href="{% url 'closeout-detail' closeout.id %}" class="btn btn-closeout btn-rounded btn-sm">Read</a>
                      <a href="#" class="btn btn-cyan btn-closeout btn-rounded btn-sm">Update</a>
                      <a href="#" class="btn btn-cyan btn-closeout btn-rounded btn-sm">PDF</a>
                    {% endif %}
                  </div>
                </div>
              </section>
              <hr class="my-5">
              {% endfor %}
              <!-- pagination start -->
                <nav>
                  <ul class="pagination pg-closeout">
                    {% if closeout_list.has_previous %}
                    <li class="page-item">
                      <a class="page-link" href="?page4={{ closeout_list.previous_page_number }}" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                        <span class="sr-only">Previous</span>
                      </a>
                    </li>
                    {% endif %}
                    {% for num in closeout_list.paginator.page_range %}
                      {% if closeout_list.number == num %}
                        <li class="page-item active"><a class="page-link" href="?page4={{ num }}">{{ num }}</a></li>
                      {% elif num > closeout_list.number|add:'-3' and num < closeout_list.number|add:'3' %}
                        <li class="page-item"><a class="page-link" href="?page4={{ num }}">{{ num }}</a></li>
                      {% endif %}
                    {% endfor %}
                    {% if closeout_list.has_next %}
                      <li class="page-item">
                        <a class="page-link" href="?page4={{ closeout_list.next_page_number }}"aria-label="Next">
                          <span aria-hidden="true">&raquo;</span>
                          <span class="sr-only">Next</span>
                        </a>
                      </li>
                      {% endif %}
                  </ul>
                </nav>
                <!-- pagination end -->
            </div>
          </div>
        </div>
    </div>
  </div>
</div>


</div>
{% endblock %}

{% block otherScripts %}
<script type="text/javascript" src="{% static 'main/js/cleave.min.js' %}"></script>
<script type="text/javascript" src="{% static 'main/js/profile.js' %}"></script>
{% endblock otherScripts %}
